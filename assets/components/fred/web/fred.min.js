!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Fred",[],t):"object"==typeof exports?exports.Fred=t():e.Fred=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=r(a),l=n(3),d=r(l),u=n(26),c=r(u),f=n(6),h=r(f),p=n(9),v=r(p),m=n(23),y=r(m),b=n(22),g=r(b),w=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),this.config=n||{},this.drake=null,this.loading=null,this.wrapper=null,document.addEventListener("DOMContentLoaded",function(){t.init()})}return o(e,[{key:"render",value:function(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("fred"),this.wrapper.addEventListener("click",function(e){e.stopImmediatePropagation()}),new c.default(this.wrapper,this.config.launcherPosition||"bottom_left"),new d.default(this.wrapper,this.config),document.body.appendChild(this.wrapper)}},{key:"getDataFromDropZone",value:function(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=e.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;t.push(s.fredEl.getContent())}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}return t}},{key:"getCleanDropZoneContent",value:function(e){for(var t=e.cloneNode(!0),n=t.querySelector(".fred--block");n;){var r=n.querySelector(".fred--block_content"),i=r.children,o=n.nextSibling,a=n.parentNode;if(n.remove(),o)for(;i.length>0;)a?a.insertBefore(i[0],o):t.insertBefore(i[0],o);else if(a)for(;i.length>0;)a.appendChild(i[0]);n=t.querySelector(".fred--block")}var s=t.querySelectorAll("[contenteditable]"),l=!0,d=!1,u=void 0;try{for(var c,f=s[Symbol.iterator]();!(l=(c=f.next()).done);l=!0){var h=c.value;h.removeAttribute("contenteditable"),h.removeAttribute("data-fred-name"),h.removeAttribute("data-fred-target")}}catch(e){d=!0,u=e}finally{try{!l&&f.return&&f.return()}finally{if(d)throw u}}var p=t.querySelectorAll("[data-fred-dropzone]"),v=!0,m=!1,y=void 0;try{for(var b,g=p[Symbol.iterator]();!(v=(b=g.next()).done);v=!0){var w=b.value;w.removeAttribute("data-fred-dropzone")}}catch(e){m=!0,y=e}finally{try{!v&&g.return&&g.return()}finally{if(m)throw y}}return t.innerHTML.trim()}},{key:"save",value:function(){s.default.emit("fred-loading","Saving Page");for(var e={},t={},n=0;n<this.dropzones.length;n++){t[this.dropzones[n].dataset.fredDropzone]=this.getDataFromDropZone(this.dropzones[n]);var r=this.dropzones[n].querySelectorAll('[data-fred-target]:not([data-fred-target=""])'),i=!0,o=!1,a=void 0;try{for(var l,d=r[Symbol.iterator]();!(i=(l=d.next()).done);i=!0){var u=l.value;e[u.dataset.fredTarget]=u.innerHTML}}catch(e){o=!0,a=e}finally{try{!i&&d.return&&d.return()}finally{if(o)throw a}}e[this.dropzones[n].dataset.fredDropzone]=this.getCleanDropZoneContent(this.dropzones[n])}e.id=this.config.resource.id,e.data=t,console.log("body: ",e),(0,h.default)(this.config.assetsUrl+"endpoints/ajax.php?action=save-content",{method:"post",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){return s.default.emit("fred-loading-hide"),e.json()})}},{key:"loadContent",value:function(){var e=this;s.default.emit("fred-loading","Preparing Content"),(0,h.default)(this.config.assetsUrl+"endpoints/ajax.php?action=load-content&id="+this.config.resource.id,{credentials:"same-origin"}).then(function(e){return e.json()}).then(function(t){var n=t.data.data,r=function(r){if(n.hasOwnProperty(r)){var i=document.querySelector('[data-fred-dropzone="'+r+'"]');i&&(i.innerHTML="",n[r].forEach(function(n){var o=document.createElement("div");o.classList.add("chunk"),o.setAttribute("hidden","hidden"),o.dataset.fredElementId=n.widget,o.innerHTML=t.data.elements[n.widget];var a=new g.default(o,r,null,n.values,n.settings||{});e.loadChildren(n.children,a,t.data.elements),i.append(a.wrapper)}))}};for(var i in n)r(i);v.default.reloadContainers(),s.default.emit("fred-loading-hide")})}},{key:"loadChildren",value:function(e,t,n){var r=this,i=function(i){e.hasOwnProperty(i)&&e[i].forEach(function(e){var o=document.createElement("div");o.classList.add("chunk"),o.setAttribute("hidden","hidden"),o.dataset.fredElementId=e.widget,o.innerHTML=n[e.widget];var a=new g.default(o,i,t,e.values,e.settings||{});t.addElementToDropZone(i,a),r.loadChildren(e.children,a,n)})};for(var o in e)i(o)}},{key:"init",value:function(){var e=this;console.log("Hello from Fred!"),this.dropzones=document.querySelectorAll('[data-fred-dropzone]:not([data-fred-dropzone=""])');for(var t=[],n=0;n<this.dropzones.length;n++){if(t.indexOf(this.dropzones[n].dataset.fredDropzone)!=-1)return console.error("There are several dropzones with same name: "+this.dropzones[n].dataset.fredDropzone+". The name of each dropzone has to be unique."),!1;t.push(this.dropzones[n].dataset.fredDropzone)}s.default.on("fred-save",function(){e.save()}),this.render(),v.default.initDrake(),y.default.init(this.wrapper),s.default.on("fred-loading",function(t){null===e.loading&&(t=t||"",e.loading=document.createElement("section"),e.loading.classList.add("fred--modal-bg"),e.loading.innerHTML='<div class="fred--modal" aria-hidden="false"><div style="color:white;text-align:center;"><span class="fred--loading"></span> '+t+"</div></div>",e.wrapper.appendChild(e.loading))}),s.default.on("fred-loading-hide",function(){null!==e.loading&&(e.loading.remove(),e.loading=null)}),s.default.on("fred-undo",function(){console.log("Undo not yet implemented.")}),this.loadContent()}}]),e}();t.default=w,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.emitter=void 0;var i=n(2),o=r(i),a=t.emitter=new o.default;t.default=a},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,i,s,l,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var u=new Error('Uncaught, unspecified "error" event. ('+t+")");throw u.context=t,u}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),d=n.slice(),i=d.length,l=0;l<i;l++)d[l].apply(this,s);return!0},n.prototype.addListener=function(e,t){var i;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,a,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],a=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(s=a;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){i=s;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=r(a),l=n(4),d=r(l),u=n(8),c=r(u),f=n(25),h=r(f),p=n(24),v=(r(p),function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.fredWrapper=t,this.lastRequest=null,this.config=r||{},this.components=[],this.visible=!1,this.hideSidebar=this.hideSidebar.bind(this),this.globalHideSidebar=this.globalHideSidebar.bind(this),s.default.on("fred-sidebar-expand",function(e,t,r){e.loading(),n.components.forEach(function(e){e.hide()}),e.expand(),n.lastRequest=(0,h.default)(Promise.resolve(r)),n.lastRequest.promise.then(function(t){n.lastRequest=null,e.setContent(t),e.afterExpand()}).catch(function(t){n.lastRequest=null,"cancel"!==t.type&&(console.log(t),e.setContent("SOMETHING WRONG HAPPENED"))})}),s.default.on("fred-sidebar-collapse",function(e){null!==n.lastRequest&&(n.lastRequest.cancel(),n.lastRequest=null),n.components.forEach(function(e){e.collapse()})}),s.default.on("fred-sidebar-hide",function(e){n.hideSidebar(e)}),s.default.on("fred-sidebar-show",function(e){n.showSidebar(e)}),s.default.on("fred-sidebar-toggle",function(){n.wrapper.classList.contains("fred--hidden")?s.default.emit("fred-sidebar-show"):s.default.emit("fred-sidebar-hide")}),this.render()}return o(e,[{key:"render",value:function(){return this.wrapper=document.createElement("div"),this.wrapper.classList.add("fred--sidebar","fred--hidden"),this.wrapper.setAttribute("aria-hidden","true"),this.wrapper.appendChild(this.buildCloseButton()),this.wrapper.appendChild(this.buildSidebarHeader()),this.wrapper.appendChild(this.buildSidebar()),this.fredWrapper.appendChild(this.wrapper),this}},{key:"buildCloseButton",value:function(){var e=document.createElement("button");return e.classList.add("fred--sidebar_close"),e.setAttribute("role","button"),e.innerHTML='<i class="fred--angle-left"></i><i class="fred--angle-left"></i>',e.addEventListener("click",function(e){e.preventDefault(),s.default.emit("fred-sidebar-hide")}),e}},{key:"buildSidebarHeader",value:function(){var e=document.createElement("div");e.classList.add("fred--sidebar_title");var t=document.createElement("img");t.setAttribute("alt","MODX FRED"),t.classList.add("fred--logo"),t.src=(this.config.assetsUrl||"")+"images/modx-revo-icon-48.svg";var n=document.createElement("h1");return n.innerText="Fred",e.appendChild(t),e.appendChild(n),e}},{key:"buildSidebar",value:function(){return this.sidebar=document.createElement("dl"),this.sidebar.classList.add("fred--accordion"),this.sidebar.setAttribute("tabindex","0"),this.sidebar.setAttribute("role","tablist"),this.components.push(new d.default(this.sidebar,this.config)),this.components.push(new c.default(this.sidebar,this.config)),this.sidebar}},{key:"hideSidebar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e===!1&&(this.visible=!1),this.wrapper.classList.add("fred--hidden"),window.removeEventListener("click",this.globalHideSidebar)}},{key:"showSidebar",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t===!0&&this.visible===!1||(this.visible=!0,this.wrapper.classList.remove("fred--hidden"),setTimeout(function(){window.addEventListener("click",e.globalHideSidebar)},50))}},{key:"globalHideSidebar",value:function(){this.hideSidebar(!1)}}]),e}());t.default=v,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),d=r(l),u=n(6),c=r(u),f=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"init",value:function(){this.content=null}},{key:"click",value:function(){var e=this;if(null!==this.content){var t=document.createElement("div");t.classList.add("fred--pages");var n=document.createElement("dl");return n.classList.add("fred--pages_list"),this.buildTree(this.content,n),t.appendChild(n),t}return(0,c.default)(this.config.assetsUrl+"endpoints/ajax.php?action=get-resources").then(function(e){return e.json()}).then(function(t){var n=document.createElement("div");n.classList.add("fred--pages");var r=document.createElement("dl");return r.classList.add("fred--pages_list"),console.log(t.data.resources),e.content=t.data.resources,e.buildTree(t.data.resources,r),n.appendChild(r),n})}},{key:"buildTree",value:function(e,t){var n=this;e.forEach(function(e){var r=document.createElement("dt");if(r.setAttribute("role","tab"),r.setAttribute("tabindex","0"),r.innerHTML=e.pagetitle,e.published!==!0&&r.classList.add("fred--pages_unpublished"),e.deleted===!0&&r.classList.add("fred--pages_deleted"),e.hidemenu===!0&&r.classList.add("fred--pages_hidden"),t.append(r),e.isFred===!0){var i=document.createElement("dd");i.appendChild(n.createMenu(e)),t.append(i)}else r.classList.add("fred--pages_noedit");if(e.children.length>0){var o=document.createElement("dl");o.classList.add("fred--pages_list","fred--hidden"),o.setAttribute("aria-disabled","true"),n.buildTree(e.children,o);var a=document.createElement("button");a.classList.add("fred--btn-list","fred--btn-list_expand"),a.addEventListener("click",function(e){return e.preventDefault(),a.classList.contains("fred--btn-list_close")?(a.classList.remove("fred--btn-list_close"),o.classList.add("fred--hidden"),void o.setAttribute("aria-disabled","true")):(a.classList.add("fred--btn-list_close"),o.classList.remove("fred--hidden"),void o.setAttribute("aria-disabled","false"))}),r.insertBefore(a,r.firstChild),t.append(o)}})}},{key:"createMenu",value:function(e){var t=document.createElement("div");t.classList.add("fred--pages_menu");var n=document.createElement("h3");n.innerHTML=e.pagetitle;var r=document.createElement("button");r.innerHTML="Edit",r.addEventListener("click",function(t){t.preventDefault(),console.log("click"),window.location.href=e.url});var i=document.createElement("button");i.innerHTML="Duplicate";var o=document.createElement("button");e.published===!0?o.innerHTML="Unpublish":o.innerHTML="Publish";var a=document.createElement("button");a.innerHTML="Create Child Page";var s=document.createElement("button");return e.deleted===!0?s.innerHTML="Undelete":s.innerHTML="Delete",t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(o),t.appendChild(a),t.appendChild(s),t}}]),t}(d.default);f.title="Pages",f.expandable=!0,t.default=f,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),d=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),this.sidebarWrapper=t,this.config=r||{},this.titleEl=null,this.contentEl=null;var o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.titleEl=document.createElement("dt"),n.titleEl.setAttribute("role","tab"),n.titleEl.setAttribute("tabindex","0"),n.titleEl.classList.add("fred--sidebar_"+n.constructor.title.toLowerCase()),n.titleEl.innerHTML=e+(t===!0?'<i class="fred--angle-right fred--accordion_toggle"></i>':""),t===!1?n.titleEl.addEventListener("click",n.click):n.titleEl.addEventListener("click",function(){n.titleEl.classList.contains("active")?l.default.emit("fred-sidebar-collapse",n):l.default.emit("fred-sidebar-expand",n,e,n.click())}),n.contentEl=document.createElement("dd"),n.sidebarWrapper.appendChild(n.titleEl),n.sidebarWrapper.appendChild(n.contentEl)};this.init(),o(this.constructor.title,this.constructor.expandable)}return a(e,[{key:"init",value:function(){}},{key:"click",value:function(){}},{key:"expand",value:function(){this.titleEl.classList.add("active"),this.titleEl.classList.remove("fred--hidden")}},{key:"collapse",value:function(){this.titleEl.classList.remove("active"),this.titleEl.classList.remove("fred--hidden")}},{key:"hide",value:function(){this.titleEl.classList.remove("active"),this.titleEl.classList.add("fred--hidden")}},{key:"setContent",value:function(e){return"object"===("undefined"==typeof e?"undefined":o(e))&&void 0!==e.outerHTML?(this.contentEl.innerHTML="",void this.contentEl.appendChild(e)):void(this.contentEl.innerHTML=e)}},{key:"loading",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e=e||"Retrieving "+this.constructor.title;var t=document.createElement("div");t.classList.add("fred--loading_wrapper"),t.innerHTML='<span class="fred--loading"></span> '+e,this.setContent(t)}},{key:"afterExpand",value:function(){}}]),e}();d.title="TITLE NOT SET",d.expandable=!1,t.default=d,e.exports=t.default},function(e,t,n){n(7),e.exports=self.fetch.bind(self)},function(e,t){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function n(e){return"string"!=typeof e&&(e=String(e)),e}function r(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return y.iterable&&(t[Symbol.iterator]=function(){return t}),t}function i(e){this.map={},e instanceof i?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function a(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function s(e){var t=new FileReader,n=a(t);return t.readAsArrayBuffer(e),n}function l(e){var t=new FileReader,n=a(t);return t.readAsText(e),n}function d(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}function u(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function c(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(y.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(y.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(y.arrayBuffer&&y.blob&&g(e))this._bodyArrayBuffer=u(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=u(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(e){var t=e.toUpperCase();return E.indexOf(t)>-1?t:e}function h(e,t){t=t||{};var n=t.body;if(e instanceof h){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new i(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new i(t.headers)),this.method=f(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function v(e){var t=new i;return e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t}function m(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new i(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var y={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(y.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};i.prototype.append=function(e,r){e=t(e),r=n(r);var i=this.map[e];this.map[e]=i?i+","+r:r},i.prototype.delete=function(e){delete this.map[t(e)]},i.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},i.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},i.prototype.set=function(e,r){this.map[t(e)]=n(r)},i.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},i.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),r(e)},i.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),r(e)},i.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),r(e)},y.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.prototype.clone=function(){return new h(this,{body:this._bodyInit})},c.call(h.prototype),c.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];m.redirect=function(e,t){if(_.indexOf(t)===-1)throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},e.Headers=i,e.Request=h,e.Response=m,e.fetch=function(e,t){return new Promise(function(n,r){var i=new h(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:v(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;n(new m(t,e))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials&&(o.withCredentials=!0),"responseType"in o&&y.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(5),d=r(l),u=n(9),c=r(u),f=n(1),h=(r(f),n(6)),p=r(h),v=n(22),m=(r(v),function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),s(t,[{key:"init",value:function(){this.content=null}},{key:"click",value:function(){var e=this;return null!==this.content?this.content:(0,p.default)(this.config.assetsUrl+"endpoints/ajax.php?action=get-elements").then(function(e){return e.json()}).then(function(n){var r=document.createElement("dl");return n.data.elements.forEach(function(e){var n=document.createElement("dt");n.setAttribute("role","tab"),n.setAttribute("tabindex","1"),n.innerHTML=e.category;var i=document.createElement("dd"),o=document.createElement("div");o.classList.add("fred--thumbs","source","blueprints-source"),e.elements.forEach(function(e){o.innerHTML+=t.elementWrapper(e.id,e.title,e.description,e.image,e.content)}),i.appendChild(o),r.append(n),r.append(i)}),e.content=r.outerHTML,e.content})}},{key:"afterExpand",value:function(){c.default.reloadContainers()}}],[{key:"elementWrapper",value:function(e,t,n,r,i){return'<figure class="fred--thumb"><div><img src="'+r+'" alt=""></div><figcaption><strong>'+t+"</strong><em>"+n+'</em></figcaption><div class="chunk" data-fred-element-id="'+e+'" hidden="hidden">'+i+"</div></figure>"}}]),t}(d.default));m.title="Elements",m.expandable=!0,t.default=m,e.exports=t.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(1),l=r(s),d=n(10),u=r(d),c=n(22),f=r(c),h=function(){function e(){o(this,e),this.drake=null}return a(e,[{key:"initDrake",value:function(){var e=this,t=[].concat(i(document.querySelectorAll('[data-fred-dropzone]:not([data-fred-dropzone=""])')));t.unshift.apply(t,i(document.querySelectorAll(".source")));var n=function(e,t){return e.contains?e!=t&&e.contains(t):!!(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)};try{this.drake=(0,u.default)(t,{copy:function(e,t){return t.classList.contains("source")},accepts:function(e,t){return!n(e,t)!=!1&&!t.classList.contains("source")},moves:function(e,t,n,r){return void 0===t.dataset.fredDropzone||""===t.dataset.fredDropzone||n.classList.contains("handle")}})}catch(e){}this.drake.on("drop",function(t,n,r,i){if(r.classList.contains("blueprints-source")&&t.parentNode){var o=n.fredEl||null,a=new f.default(t.getElementsByClassName("chunk")[0],n.dataset.fredDropzone,o);o&&(null===i?o.dzs[n.dataset.fredDropzone].children.push(a.wrapper):o.dzs[n.dataset.fredDropzone].children.splice(o.dzs[n.dataset.fredDropzone].children.indexOf(i),0,a.wrapper)),t.parentNode.replaceChild(a.wrapper,t)}else if(n&&t.fredEl){t.fredEl.parent&&t.fredEl.parent.dzs[r.dataset.fredDropzone].children.splice(t.fredEl.parent.dzs[r.dataset.fredDropzone].children.indexOf(t),1);var s=n.fredEl||null;s&&(null===i?s.dzs[n.dataset.fredDropzone].children.push(t):s.dzs[n.dataset.fredDropzone].children.splice(s.dzs[n.dataset.fredDropzone].children.indexOf(i),0,t)),
t.fredEl.parent=s,t.fredEl.dzName=n.dataset.fredDropzone}e.reloadContainers()}),this.drake.on("drag",function(e,t){var n=document.querySelectorAll("[data-fred-dropzone]"),r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var d=a.value;d.classList.add("fred--dropzone_highlight")}}catch(e){i=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}l.default.emit("fred-sidebar-hide",!0)}),this.drake.on("dragend",function(e){var t=document.querySelectorAll("[data-fred-dropzone]"),n=!0,r=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;s.classList.remove("fred--dropzone_highlight")}}catch(e){r=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw i}}l.default.emit("fred-sidebar-show",!0)})}},{key:"reloadContainers",value:function(){for(var e=document.querySelectorAll('[data-fred-dropzone]:not([data-fred-dropzone=""])'),t=[].concat(i(e)),n=0;n<e.length;n++)t.push.apply(t,i(e[n].querySelectorAll('[data-fred-dropzone]:not([data-fred-dropzone=""])')));t.unshift.apply(t,i(document.querySelectorAll(".source"))),this.drake.containers=t}}]),e}(),p=new h;t.default=p,e.exports=t.default},function(e,t,n){(function(t){"use strict";function r(e,t){function n(e){return ue.containers.indexOf(e)!==-1||de.isContainer(e)}function r(e){var t=e?"remove":"add";i(L,t,"mousedown",x),i(L,t,"mouseup",M)}function s(e){var t=e?"remove":"add";i(L,t,"mousemove",C)}function v(e){var t=e?"remove":"add";w[t](L,"selectstart",T),w[t](L,"click",T)}function y(){r(!0),M({})}function T(e){se&&e.preventDefault()}function x(e){te=e.clientX,ne=e.clientY;var t=1!==o(e)||e.metaKey||e.ctrlKey;if(!t){var n=e.target,r=k(n);r&&(se=r,s(),"mousedown"===e.type&&(p(n)?n.focus():e.preventDefault()))}}function C(e){if(se){if(0===o(e))return void M({});if(void 0===e.clientX||e.clientX!==te||void 0===e.clientY||e.clientY!==ne){if(de.ignoreInputTextSelection){var t=b("clientX",e),n=b("clientY",e),r=_.elementFromPoint(t,n);if(p(r))return}var i=se;s(!0),v(),P(),z(i);var l=a(J);Q=b("pageX",e)-l.left,ee=b("pageY",e)-l.top,E.add(oe||J,"gu-transit"),W(),U(e)}}}function k(e){if(!(ue.dragging&&K||n(e))){for(var t=e;h(e)&&n(h(e))===!1;){if(de.invalid(e,t))return;if(e=h(e),!e)return}var r=h(e);if(r&&!de.invalid(e,t)){var i=de.moves(e,r,t,m(e));if(i)return{item:e,source:r}}}}function S(e){return!!k(e)}function O(e){var t=k(e);t&&z(t)}function z(e){G(e.item,e.source)&&(oe=e.item.cloneNode(!0),ue.emit("cloned",oe,e.item,"copy")),V=e.source,J=e.item,re=ie=m(e.item),ue.dragging=!0,ue.emit("drag",J,V)}function A(){return!1}function P(){if(ue.dragging){var e=oe||J;j(e,h(e))}}function D(){se=!1,s(!0),v(!0)}function M(e){if(D(),ue.dragging){var t=oe||J,n=b("clientX",e),r=b("clientY",e),i=l(K,n,r),o=R(i,n,r);o&&(oe&&de.copySortSource||!oe||o!==V)?j(t,o):de.removeOnSpill?I():B()}}function j(e,t){var n=h(e);oe&&de.copySortSource&&t===V&&n.removeChild(J),N(t)?ue.emit("cancel",e,V,V):ue.emit("drop",e,t,V,ie),H()}function I(){if(ue.dragging){var e=oe||J,t=h(e);t&&t.removeChild(e),ue.emit(oe?"cancel":"remove",e,t,V),H()}}function B(e){if(ue.dragging){var t=arguments.length>0?e:de.revertOnSpill,n=oe||J,r=h(n),i=N(r);i===!1&&t&&(oe?r&&r.removeChild(oe):V.insertBefore(n,re)),i||t?ue.emit("cancel",n,V,V):ue.emit("drop",n,r,V,ie),H()}}function H(){var e=oe||J;D(),X(),e&&E.rm(e,"gu-transit"),ae&&clearTimeout(ae),ue.dragging=!1,le&&ue.emit("out",e,le,V),ue.emit("dragend",e),V=J=oe=re=ie=ae=le=null}function N(e,t){var n;return n=void 0!==t?t:K?ie:m(oe||J),e===V&&n===re}function R(e,t,r){function i(){var i=n(o);if(i===!1)return!1;var a=Y(o,e),s=Z(o,a,t,r),l=N(o,s);return!!l||de.accepts(J,o,V,s)}for(var o=e;o&&!i();)o=h(o);return o}function U(e){function t(e){ue.emit(e,d,le,V)}function n(){f&&t("over")}function r(){le&&t("out")}if(K){e.preventDefault();var i=b("clientX",e),o=b("clientY",e),a=i-Q,s=o-ee;K.style.left=a+"px",K.style.top=s+"px";var d=oe||J,u=l(K,i,o),c=R(u,i,o),f=null!==c&&c!==le;(f||null===c)&&(r(),le=c,n());var p=h(d);if(c===V&&oe&&!de.copySortSource)return void(p&&p.removeChild(d));var v,y=Y(c,u);if(null!==y)v=Z(c,y,i,o);else{if(de.revertOnSpill!==!0||oe)return void(oe&&p&&p.removeChild(d));v=re,c=V}(null===v&&f||v!==d&&v!==m(d))&&(ie=v,c.insertBefore(d,v),ue.emit("shadow",d,c,V))}}function q(e){E.rm(e,"gu-hide")}function F(e){ue.dragging&&E.add(e,"gu-hide")}function W(){if(!K){var e=J.getBoundingClientRect();K=J.cloneNode(!0),K.style.width=c(e)+"px",K.style.height=f(e)+"px",E.rm(K,"gu-transit"),E.add(K,"gu-mirror"),de.mirrorContainer.appendChild(K),i(L,"add","mousemove",U),E.add(de.mirrorContainer,"gu-unselectable"),ue.emit("cloned",K,J,"mirror")}}function X(){K&&(E.rm(de.mirrorContainer,"gu-unselectable"),i(L,"remove","mousemove",U),h(K).removeChild(K),K=null)}function Y(e,t){for(var n=t;n!==e&&h(n)!==e;)n=h(n);return n===L?null:n}function Z(e,t,n,r){function i(){var t,i,o,a=e.children.length;for(t=0;t<a;t++){if(i=e.children[t],o=i.getBoundingClientRect(),s&&o.left+o.width/2>n)return i;if(!s&&o.top+o.height/2>r)return i}return null}function o(){var e=t.getBoundingClientRect();return a(s?n>e.left+c(e)/2:r>e.top+f(e)/2)}function a(e){return e?m(t):t}var s="horizontal"===de.direction,l=t!==e?o():i();return l}function G(e,t){return"boolean"==typeof de.copy?de.copy:de.copy(e,t)}var $=arguments.length;1===$&&Array.isArray(e)===!1&&(t=e,e=[]);var K,V,J,Q,ee,te,ne,re,ie,oe,ae,se,le=null,de=t||{};void 0===de.moves&&(de.moves=u),void 0===de.accepts&&(de.accepts=u),void 0===de.invalid&&(de.invalid=A),void 0===de.containers&&(de.containers=e||[]),void 0===de.isContainer&&(de.isContainer=d),void 0===de.copy&&(de.copy=!1),void 0===de.copySortSource&&(de.copySortSource=!1),void 0===de.revertOnSpill&&(de.revertOnSpill=!1),void 0===de.removeOnSpill&&(de.removeOnSpill=!1),void 0===de.direction&&(de.direction="vertical"),void 0===de.ignoreInputTextSelection&&(de.ignoreInputTextSelection=!0),void 0===de.mirrorContainer&&(de.mirrorContainer=_.body);var ue=g({containers:de.containers,start:O,end:P,cancel:B,remove:I,destroy:y,canMove:S,dragging:!1});return de.removeOnSpill===!0&&ue.on("over",q).on("out",F),r(),ue}function i(e,n,r,i){var o={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"},a={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"},s={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};t.navigator.pointerEnabled?w[n](e,a[r],i):t.navigator.msPointerEnabled?w[n](e,s[r],i):(w[n](e,o[r],i),w[n](e,r,i))}function o(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var t=e.button;return void 0!==t?1&t?1:2&t?3:4&t?2:0:void 0}function a(e){var t=e.getBoundingClientRect();return{left:t.left+s("scrollLeft","pageXOffset"),top:t.top+s("scrollTop","pageYOffset")}}function s(e,n){return"undefined"!=typeof t[n]?t[n]:L.clientHeight?L[e]:_.body[e]}function l(e,t,n){var r,i=e||{},o=i.className;return i.className+=" gu-hide",r=_.elementFromPoint(t,n),i.className=o,r}function d(){return!1}function u(){return!0}function c(e){return e.width||e.right-e.left}function f(e){return e.height||e.bottom-e.top}function h(e){return e.parentNode===_?null:e.parentNode}function p(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||v(e)}function v(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||v(h(e))))}function m(e){function t(){var t=e;do t=t.nextSibling;while(t&&1!==t.nodeType);return t}return e.nextElementSibling||t()}function y(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function b(e,t){var n=y(t),r={pageX:"clientX",pageY:"clientY"};return e in r&&!(e in n)&&r[e]in n&&(e=r[e]),n[e]}var g=n(11),w=n(18),E=n(21),_=document,L=_.documentElement;e.exports=r}).call(t,function(){return this}())},function(e,t,n){"use strict";var r=n(12),i=n(13);e.exports=function(e,t){var n=t||{},o={};return void 0===e&&(e={}),e.on=function(t,n){return o[t]?o[t].push(n):o[t]=[n],e},e.once=function(t,n){return n._once=!0,e.on(t,n),e},e.off=function(t,n){var r=arguments.length;if(1===r)delete o[t];else if(0===r)o={};else{var i=o[t];if(!i)return e;i.splice(i.indexOf(n),1)}return e},e.emit=function(){var t=r(arguments);return e.emitterSnapshot(t.shift()).apply(this,t)},e.emitterSnapshot=function(t){var a=(o[t]||[]).slice(0);return function(){var o=r(arguments),s=this||e;if("error"===t&&n.throws!==!1&&!a.length)throw 1===o.length?o[0]:o;return a.forEach(function(r){n.async?i(r,o,s):r.apply(s,o),r._once&&e.off(t,r)}),e}},e}},function(e,t){e.exports=function(e,t){return Array.prototype.slice.call(e,t)}},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t,n){e&&r(function(){e.apply(n||null,t||[])})}},function(e,t,n){(function(t){var n,r="function"==typeof t;n=r?function(e){t(e)}:function(e){setTimeout(e,0)},e.exports=n}).call(t,n(15).setImmediate)},function(e,t,n){(function(e){function r(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(16),t.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(t,function(){return this}())},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return v[p]=r,h(p),p++}function i(e){delete v[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function a(e){if(m)setTimeout(a,0,e);else{var t=v[e];if(t){m=!0;try{o(t)}finally{i(e),m=!1}}}}function s(){h=function(e){t.nextTick(function(){a(e)})}}function l(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function d(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),h=function(n){e.postMessage(t+n,"*")}}function u(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},h=function(t){e.port2.postMessage(t)}}function c(){var e=y.documentElement;h=function(t){var n=y.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function f(){h=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var h,p=1,v={},m=!1,y=e.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(e);b=b&&b.setTimeout?b:e,"[object process]"==={}.toString.call(e.process)?s():l()?d():e.MessageChannel?u():y&&"onreadystatechange"in y.createElement("script")?c():f(),b.setImmediate=r,b.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(t,function(){return this}(),n(17))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(c===clearTimeout)return clearTimeout(e);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function a(){v&&h&&(v=!1,h.length?p=h.concat(p):m=-1,p.length&&s())}function s(){if(!v){var e=i(a);v=!0;for(var t=p.length;t;){for(h=p,p=[];++m<t;)h&&h[m].run();m=-1,t=p.length}h=null,v=!1,o(e)}}function l(e,t){this.fun=e,this.array=t}function d(){}var u,c,f=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var h,p=[],v=!1,m=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new l(e,t)),1!==p.length||v||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=d,f.addListener=d,f.once=d,f.off=d,f.removeListener=d,f.removeAllListeners=d,f.emit=d,f.prependListener=d,f.prependOnceListener=d,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){(function(t){"use strict";function r(e,t,n,r){return e.addEventListener(t,n,r)}function i(e,t,n){return e.attachEvent("on"+t,d(e,t,n))}function o(e,t,n,r){return e.removeEventListener(t,n,r)}function a(e,t,n){var r=u(e,t,n);if(r)return e.detachEvent("on"+t,r)}function s(e,t,n){function r(){var e;return p.createEvent?(e=p.createEvent("Event"),e.initEvent(t,!0,!0)):p.createEventObject&&(e=p.createEventObject()),e}function i(){return new f(t,{detail:n})}var o=h.indexOf(t)===-1?i():r();e.dispatchEvent?e.dispatchEvent(o):e.fireEvent("on"+t,o)}function l(e,n,r){return function(n){var i=n||t.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},i.which=i.which||i.keyCode,r.call(e,i)}}function d(e,t,n){var r=u(e,t,n)||l(e,t,n);return y.push({wrapper:r,element:e,type:t,fn:n}),r}function u(e,t,n){var r=c(e,t,n);if(r){var i=y[r].wrapper;return y.splice(r,1),i}}function c(e,t,n){var r,i;for(r=0;r<y.length;r++)if(i=y[r],i.element===e&&i.type===t&&i.fn===n)return r}var f=n(19),h=n(20),p=t.document,v=r,m=o,y=[];t.addEventListener||(v=i,m=a),e.exports={add:v,remove:m,fabricate:s}}).call(t,function(){return this}())},function(e,t){(function(t){function n(){try{var e=new r("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(e){}return!1}var r=t.CustomEvent;e.exports=n()?r:"function"==typeof document.createEvent?function(e,t){var n=document.createEvent("CustomEvent");return t?n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail):n.initCustomEvent(e,!1,!1,void 0),n}:function(e,t){var n=document.createEventObject();return n.type=e,t?(n.bubbles=Boolean(t.bubbles),n.cancelable=Boolean(t.cancelable),n.detail=t.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n}}).call(t,function(){return this}())},function(e,t){(function(t){"use strict";var n=[],r="",i=/^on/;for(r in t)i.test(r)&&n.push(r.slice(2));e.exports=n}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){var t=o[e];return t?t.lastIndex=0:o[e]=t=new RegExp(a+e+s,"g"),t}function r(e,t){var r=e.className;r.length?n(t).test(r)||(e.className+=" "+t):e.className=t}function i(e,t){e.className=e.className.replace(n(t)," ").trim()}var o={},a="(?:^|\\s)",s="(?:\\s|$)";e.exports={add:r,rm:i}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ContentElement=void 0;var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),d=n(23),u=r(d),c=t.ContentElement=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};i(this,e),this.el=t,this.id=parseInt(this.el.dataset.fredElementId),this.parent=r,this.dzName=n,this.content=o({},a),this.settings=o({},s),this.dzs={},this.wrapper=this.render()}return a(e,[{key:"getContent",value:function(){var e=this,t={widget:this.id,values:this.content,settings:this.settings,children:{}},n=function(n){e.dzs.hasOwnProperty(n)&&e.dzs[n].children.length>0&&(t.children[n]=[],e.dzs[n].children.forEach(function(e){t.children[n].push(e.fredEl.getContent())}))};for(var r in this.dzs)n(r);return t}},{key:"render",value:function(){var e=this,t=document.createElement("div");t.classList.add("fred--block"),t.fredEl=this,t.addEventListener("mouseover",function(e){t.classList.add("fred--block-active")}),t.addEventListener("mouseout",function(e){t.classList.remove("fred--block-active")});var n=document.createElement("div");n.classList.add("fred--toolbar");var r=document.createElement("button");r.classList.add("fred--move-icon","handle");var i=document.createElement("button");i.classList.add("fred--duplicate-icon"),i.addEventListener("click",function(t){t.preventDefault(),e.duplicate()});var o=document.createElement("button");o.classList.add("fred--trash"),o.addEventListener("click",function(t){t.preventDefault(),e.remove()}),n.appendChild(r),n.appendChild(i),n.appendChild(o),t.appendChild(n);var a=document.createElement("div");a.classList.add("fred--block_content"),a.dataset.fredElementId=this.el.dataset.fredElementId,a.innerHTML=this.el.innerHTML;var s=a.querySelectorAll("[data-fred-dropzone]"),l=null,d=!0,c=!1,f=void 0;try{for(var h,p=function(){var t=h.value;null===l?(l=t,t.fredEl=e,e.dzs[t.dataset.fredDropzone]?(e.dzs[t.dataset.fredDropzone].el=t,e.dzs[t.dataset.fredDropzone].children.forEach(function(n){e.dzs[t.dataset.fredDropzone].el.appendChild(n)})):e.dzs[t.dataset.fredDropzone]={el:t,children:[]}):l.contains(t)||(t.fredEl=e,l=t,e.dzs[t.dataset.fredDropzone]?(e.dzs[t.dataset.fredDropzone].el=t,e.dzs[t.dataset.fredDropzone].children.forEach(function(n){e.dzs[t.dataset.fredDropzone].el.appendChild(n)})):e.dzs[t.dataset.fredDropzone]={el:t,children:[]})},v=s[Symbol.iterator]();!(d=(h=v.next()).done);d=!0)p()}catch(e){c=!0,f=e}finally{try{!d&&v.return&&v.return()}finally{if(c)throw f}}for(var m in this.settings)this.settings.hasOwnProperty(m)&&(a.innerHTML=a.innerHTML.replace(new RegExp("{{"+m+"}}","g"),this.settings[m]));return a.querySelectorAll('[contenteditable="true"]').forEach(function(t){var n=new MutationObserver(function(n){n.forEach(function(n){return"characterData"===n.type?void(e.content[t.dataset.fredName]=t.innerHTML):"attributes"===n.type&&"src"===n.attributeName?void(e.content[t.dataset.fredName]=t.getAttribute(n.attributeName)):void 0})});if(n.observe(t,{attributes:!0,characterData:!0,subtree:!0}),e.content[t.dataset.fredName])switch(t.nodeName.toLowerCase()){case"img":t.setAttribute("src",e.content[t.dataset.fredName]);break;default:t.innerHTML=e.content[t.dataset.fredName]}}),a.querySelectorAll('img[contenteditable="true"]').forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),u.default.edit(e)})}),t.appendChild(a),t}},{key:"reRender",value:function(){var e=this.render();this.wrapper.replaceWith(e),this.wrapper=e}},{key:"remove",value:function(){if(this.parent){var e=this.parent.dzs[this.dzName].children.indexOf(this.wrapper);e>-1&&this.parent.dzs[this.dzName].children.splice(e,1)}this.wrapper.remove()}},{key:"duplicateDropZones",value:function(t){var n=this,r=function(r){t.hasOwnProperty(r)&&t[r].children.forEach(function(t){if(n.dzs[r]){var i=new e(t.fredEl.el,r,n,t.fredEl.content,t.fredEl.settings);n.addElementToDropZone(r,i),i.duplicateDropZones(t.fredEl.dzs)}})};for(var i in t)r(i)}},{key:"duplicate",value:function(){var t=new e(this.el,this.dzName,this.parent,this.content,this.settings);if(t.duplicateDropZones(this.dzs),null===this.wrapper.nextSibling?this.wrapper.parentNode.appendChild(t.wrapper):this.wrapper.parentNode.insertBefore(t.wrapper,this.wrapper.nextSibling),this.parent){var n=this.parent.dzs[this.dzName].children.indexOf(this.wrapper);n>-1&&this.parent.dzs[this.dzName].children.splice(n+1,0,t.wrapper)}return l.default.reloadContainers(),!0}},{key:"addElementToDropZone",value:function(e,t){return!!this.dzs[e]&&(this.dzs[e].children.push(t.wrapper),this.dzs[e].el.appendChild(t.wrapper),!0)}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(24),s=r(a),l=function(){function e(){i(this,e),this.fredWrapper=null,this.inited=!1}return o(e,[{key:"init",value:function(e){this.inited!==!0&&(this.fredWrapper=e,this.inited=!0)}},{key:"edit",value:function(e){var t=document.createElement("input");t.setAttribute("type","text"),t.value=e.src;var n=new s.default(this.fredWrapper,"Edit Image",t,function(){e.src=t.value});n.render()}}]),e}(),d=new l;t.default=d,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=t.Modal=function(){function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};n(this,e),this.fredWrapper=t,this.wrapper=null,this.title=r,this.content=i,this.onSave=o}return r(e,[{key:"setTitle",value:function(e){this.title=e,null!==this.wrapper&&(this.titleEl.innerHTML=e)}},{key:"setContent",value:function(e){this.content=e,null!==this.wrapper&&("string"==typeof this.content?this.body.innerHTML=this.content:(this.body.innerHTML="",this.body.appendChild(this.content)))}},{key:"render",value:function(){var e=this;this.wrapper=document.createElement("section"),this.wrapper.classList.add("fred--modal-bg");var t=document.createElement("div");t.classList.add("fred--modal"),t.setAttribute("aria-hidden","true");var n=document.createElement("div");n.classList.add("fred--modal-header");var r=document.createElement("button");r.classList.add("button"),r.innerHTML='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="20px" height="20px" viewBox="-4 -4 20 20" enable-background="new -4 -4 20 20" xml:space="preserve"><polygon points="16.079,-0.666 12.717,-4.027 6.052,2.637 -0.613,-4.027 -3.975,-0.666 2.69,6 -3.975,12.664 -0.612,16.026 6.052,9.362 12.717,16.027 16.079,12.664 9.414,6 "></polygon></svg>',r.addEventListener("click",this.close.bind(this)),this.titleEl=document.createElement("h4"),this.titleEl.innerHTML=this.title,this.body=document.createElement("div"),this.body.classList.add("fred--modal-body"),"string"==typeof this.content?this.body.innerHTML=this.content:this.body.appendChild(this.content);var i=document.createElement("div");i.classList.add("fred--modal-footer");var o=document.createElement("button");return o.classList.add("fred--btn-small"),o.setAttribute("type","button"),o.innerHTML="Save",o.addEventListener("click",function(t){t.preventDefault(),e.onSave(),e.close()}),n.appendChild(r),n.appendChild(this.titleEl),i.appendChild(o),t.appendChild(n),t.appendChild(this.body),t.appendChild(i),this.wrapper.appendChild(t),this.fredWrapper.appendChild(this.wrapper),this.wrapper}},{key:"close",value:function(){this.wrapper.remove()}}]),e}();t.default=i},function(e,t){var n=function(e,t){function n(){o=!0,r()}t=t||{};var r,i=t.timeout,o=!1,a=new Promise(function(e,t){r=e}),s=Promise.race([a,e]).then(function(e){if(o){var t=new Error("User cancelled promise.");return t.type="cancel",Promise.reject(t)}if(i){var t=new Error("Promise timeout");return t.type="timeout",Promise.reject(t)}return Promise.resolve(e)});return t.timeout&&setTimeout(function(){i=!0,r()},+t.timeout),{promise:s,cancel:n,abort:n}};e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(1),s=r(a),l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottom_left";i(this,e),this.fredWrapper=t,this.position=n,this.render()}return o(e,[{key:"render",value:function(){var e=document.createElement("div");e.classList.add("fred--launcher","fred--launcher_"+this.position);var t=document.createElement("button");t.classList.add("fred--launcher_btn","fred--launcher_btn_fred"),t.setAttribute("role","button"),t.addEventListener("click",function(e){e.preventDefault(),s.default.emit("fred-sidebar-toggle")});var n=document.createElement("button");n.classList.add("fred--launcher_btn","fred--launcher_btn_save"),n.setAttribute("role","button"),n.addEventListener("click",function(e){e.preventDefault(),s.default.emit("fred-save")});var r=document.createElement("button");r.classList.add("fred--launcher_btn","fred--launcher_btn_undo"),r.setAttribute("role","button"),r.addEventListener("click",function(e){e.preventDefault(),s.default.emit("fred-undo")}),e.appendChild(t),e.appendChild(n),e.appendChild(r),this.fredWrapper.appendChild(e)}}]),e}();t.default=l,e.exports=t.default}])});